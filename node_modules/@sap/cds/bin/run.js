module.exports = Object.assign (run, { help: `
# SYNOPSIS

    *cds run* [ <project> ]

    Starts an http server which loads models from the given folder, or from
    the current working directory if omitted, and  generically serves all
    services defined in the found models.

`})


function run (projects, options) {
    if (projects.length > 0) {
        let {fork} = require ('child_process'), port = 4004
        for (let each of projects) {
            console.log (`[cds] - running ${each}...`)
            fork (__filename, { cwd:each, env:{PORT: port++} })
        }
    }
    else  run_current (options)
}

const serve = require ('./serve')
function run_current (options) {
    return serve ('all', options)
}

if (!module.parent)  run_current()
/* eslint no-console:off */
