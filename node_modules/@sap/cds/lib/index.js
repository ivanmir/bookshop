const core = require ('@sap/cds-reflect'), $=require;  require = (id)=> lazy=> $(id)  // eslint-disable-line
const cds = module.exports = global.cds = Object.assign ( core, {

    // Model Processing
    resolve: require ('./models/resolve'),
    load: require ('./models/load'),
    parse: require ('./models/parse'),
    compile: require ('./models/compile'),
    localize: require ('./models/i18n'),
    unfold: lazy => cds.compile,
    get: lazy => cds.load.only,

    // Services and Querying
    connect: require ('./runtime/connect'),
    serve: require ('./runtime/serve'),
    ql: lazy => cds.connect.ql,

    // Helpers
    in: cwd => !cwd ? cds : {__proto__:cds, cwd, env:cds.env.in(cwd) },
    require: require ('./utils/require-local'),
    env: require ('./utils/config'),
    write: require ('./utils/write'),
    home: lazy => __dirname.slice(0,-4),
    version: lazy => require('../package.json').version,

    // Compatibility
    get config(){ return this.env },

})
cds.lazify()
