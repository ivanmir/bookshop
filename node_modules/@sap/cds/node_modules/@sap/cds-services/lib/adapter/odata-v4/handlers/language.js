const negotiateLocale = require('../../utils/locale')
const {toODataResult} = require('../utils/event')

/**
 * Provide handler for localization negotiation.
 * @param {Object} options
 * @return {Function}
 */
const negotiate = (options) => {
  return (req, res, next) => {
    const locale = negotiateLocale(req, options)
    req._inRequest.locale = locale
    next(null, toODataResult(locale))
  }
}

module.exports = negotiate
