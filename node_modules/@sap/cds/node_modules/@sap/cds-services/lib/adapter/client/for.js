const _getService = (serviceName) => {
  const cds = require('../../cds')

  const service = cds.service.providers.find((provider) => {
    return (provider.path === serviceName || provider.service === serviceName)
  })

  if (!service) {
    const {NoServiceFound} = require('../../errors')
    throw new NoServiceFound()
  }

  return service
}

const forService = (serviceName) => {
  const service = _getService(serviceName)
  const Client = require('./Client')

  return new Client(service)
}

module.exports = forService
